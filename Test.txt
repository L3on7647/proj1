Sub PowerPointgaAniqYozish()
    Dim pptApp As Object
    Dim pptPres As Object
    Dim pptSlide As Object
    Dim excelSheet As Worksheet
    Dim lastRow As Long, i As Long
    Dim pptPath As String
    Dim shp As Object
    Dim tbl As Object
    
    ' --- SOZLAMALAR ---
    ' PowerPoint manzili:
    pptPath = "C:\Users\User\Desktop\Паспорт шаблон (002) (002).pptx" 
    
    ' Excel varaq nomi:
    Set excelSheet = ThisWorkbook.Sheets("TABLE")
    ' ------------------

    If Dir(pptPath) = "" Then MsgBox "Fayl topilmadi!", vbCritical: Exit Sub

    On Error Resume Next
    Set pptApp = GetObject(, "PowerPoint.Application")
    If Err.Number <> 0 Then Set pptApp = CreateObject("PowerPoint.Application")
    On Error GoTo 0
    
    pptApp.Visible = True
    Set pptPres = pptApp.Presentations.Open(pptPath)
    lastRow = excelSheet.Cells(excelSheet.Rows.Count, 1).End(xlUp).Row

    ' --- SIKL ---
    For i = 2 To lastRow
        
        ' 1. Slayddan nusxa olamiz
        pptPres.Slides(1).Duplicate
        Set pptSlide = pptPres.Slides(2) ' Har doim 2-slayd bilan ishlaymiz (chunki 1 bu shablon)
        
        ' 2. Slayddagi jadvalni topamiz
        For Each shp In pptSlide.Shapes
            If shp.HasTable Then
                Set tbl = shp.Table
                
                ' DIQQAT: Bu yerda qaysi qatorga nima yozilishi ko'rsatilgan.
                ' Rasmga qarab sanab chiqdim (Sizda 1-qator bu sarlavha).
                ' (Row = Qator, Column = Ustun)
                
                ' Балансда сақловчи (3-qator, 2-ustun) <- Excel A ustun (1)
                tbl.Cell(3, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 1).Value
                
                ' Мулк номи (4-qator, 2-ustun) <- Excel B ustun (2)
                tbl.Cell(4, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 2).Value
                
                ' Манзили (5-qator, 2-ustun) <- Excel C ustun (3)
                tbl.Cell(5, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 3).Value
                
                ' Майдони (6-qator, 2-ustun) <- Excel D ustun (4)
                tbl.Cell(6, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 4).Value
                
                ' Тавсифи (7-qator, 2-ustun) <- Excel E ustun (5)
                tbl.Cell(7, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 5).Value
                
                ' Коммуникация (8-qator, 2-ustun) <- Excel F ustun (6)
                tbl.Cell(8, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 6).Value
                
                ' Ҳолати (9-qator, 2-ustun) <- Excel G ustun (7)
                tbl.Cell(9, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 7).Value
                
                ' Сана (10-qator, 2-ustun) <- Excel H ustun (8)
                tbl.Cell(10, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 8).Value
                
                ' Қиймати (11-qator, 2-ustun) <- Excel I ustun (9)
                tbl.Cell(11, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 9).Value
                
                ' Shartlari (12-qator, 2-ustun) <- Excel J ustun (10)
                tbl.Cell(12, 2).Shape.TextFrame.TextRange.Text = excelSheet.Cells(i, 10).Value
                
            End If
        Next shp
        
        ' 3. Tayyor slaydni oxiriga tashlaymiz
        pptSlide.MoveTo toPos:=pptPres.Slides.Count
        
    Next i

    MsgBox "Bajarildi!", vbInformation
End Sub
