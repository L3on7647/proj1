Sub DamasKirillcha()
    Dim srcSlide As Slide
    Dim newSlide As Slide
    Dim shp As Shape
    Dim picColl As New Collection
    Dim i As Integer
    
    ' 1. Hozirgi slaydni aniqlash
    Set srcSlide = ActiveWindow.View.Slide
    
    ' 2. Rasmlarni yig'ish (Guruhlangan yoki Placeholder ichida bo'lsa ham topadi)
    For Each shp In srcSlide.Shapes
        If shp.Type = msoPicture Or shp.Type = msoLinkedPicture Then
            picColl.Add shp
        ElseIf shp.Type = msoPlaceholder Then
            If shp.PlaceholderFormat.ContainedType = msoPicture Then picColl.Add shp
        ElseIf shp.Type = msoGroup Then
            Dim subShp As Shape
            For Each subShp In shp.GroupItems
                If subShp.Type = msoPicture Then picColl.Add subShp
            Next subShp
        End If
    Next shp
    
    If picColl.Count = 0 Then
        MsgBox "Rasm topilmadi!", vbExclamation
        Exit Sub
    End If

    ' 3. YANGI SLAYD OCHISH
    Set newSlide = ActivePresentation.Slides.Add(srcSlide.SlideIndex + 1, ppLayoutBlank)
    
    ' --- SARLAVHA (Kirillcha) ---
    Dim titleBox As Shape
    Set titleBox = newSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 0, 20, 960, 50)
    With titleBox
        .Fill.ForeColor.RGB = RGB(141, 180, 226) ' Damas foniga o'xshash ko'k
        .TextFrame.TextRange.Text = "ОБЪЕКТ ПАСПОРТИ"
        .TextFrame.TextRange.Font.Name = "Calibri"
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Size = 28
        .TextFrame.TextRange.Font.Color.RGB = RGB(255, 255, 255) ' Oq yozuv
        .TextFrame.TextRange.ParagraphFormat.Alignment = ppAlignCenter
        .TextFrame.VerticalAnchor = msoAnchorMiddle
    End With
    
    ' --- JADVAL (Chap tomon - Kirillcha) ---
    Dim tbl As Shape
    Set tbl = newSlide.Shapes.AddTable(9, 2, 30, 90, 420, 400)
    With tbl.Table
        .Columns(1).Width = 140
        .Columns(2).Width = 280
        
        ' Yozuvlarni Kirillchaga o'zgartirdim
        SetCellText tbl.Table, 1, 1, "Балансда сақловчи"
        SetCellText tbl.Table, 2, 1, "Мулк номи"
        SetCellText tbl.Table, 3, 1, "Манзили"
        SetCellText tbl.Table, 4, 1, "Майдони"
        SetCellText tbl.Table, 5, 1, "Тавсифи"
        SetCellText tbl.Table, 6, 1, "Коммуникация"
        SetCellText tbl.Table, 7, 1, "Ҳолати"
        SetCellText tbl.Table, 8, 1, "Балансга олинган сана"
        SetCellText tbl.Table, 9, 1, "Баланс қиймати"
        
        ' 7-qator (Holati) ga standart "Қониқарли" deb yozib qo'yamiz (Damasdagidek)
        SetCellText tbl.Table, 7, 2, "Қониқарли"
        
        ' Jadval stili
        .ApplyStyle "{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"
    End With

    ' --- RASMLARNI JOYLASH (O'ng tomon - Zich 2x2) ---
    Dim imgW As Single, imgH As Single
    Dim startX As Single, startY As Single
    Dim gap As Single
    Dim r As Integer, c As Integer
    Dim newPic As ShapeRange
    
    ' Parametrlarni "Damas" rasmidagidek to'g'irlaymiz
    startX = 470   ' Jadvalga yaqinroq
    startY = 90    ' Jadval bilan bir chiziqda
    imgW = 230     ' Rasm kattaroq
    imgH = 160     ' Balandligi
    gap = 5        ' Orasi juda yaqin (zich) bo'lishi kerak
    
    For i = 1 To picColl.Count
        If i > 4 Then Exit For
        
        picColl(i).Copy
        Set newPic = newSlide.Shapes.Paste
        
        r = (i - 1) \ 2
        c = (i - 1) Mod 2
        
        With newPic
            .LockAspectRatio = msoTrue
            .Width = imgW
            
            ' Ekranga sig'may qolmasligi va bir xil turishi uchun "Crop" qilamiz
            If .Height > imgH Then
                .PictureFormat.CropBottom = .Height - imgH
            ElseIf .Height < imgH Then
                ' Agar rasm kichkina bo'lsa, o'rtada tursin (muammo bo'lmasligi uchun)
            End If
            
            .Left = startX + (c * (imgW + gap))
            .Top = startY + (r * (imgH + gap))
            
            ' Oq ramka (Damas stilida rasmlar ajralib turishi uchun)
            .Line.Visible = msoTrue
            .Line.ForeColor.RGB = RGB(255, 255, 255)
            .Line.Weight = 3
        End With
    Next i
    
    MsgBox "Tayyor! Kirillcha variant yaratildi.", vbInformation
End Sub

' Yozuv yozishni osonlashtiruvchi yordamchi kod
Sub SetCellText(t As Table, r As Integer, c As Integer, txt As String)
    t.Cell(r, c).Shape.TextFrame.TextRange.Text = txt
    t.Cell(r, c).Shape.TextFrame.TextRange.Font.Name = "Calibri"
    t.Cell(r, c).Shape.TextFrame.TextRange.Font.Size = 11
    ' Chap ustunni qalin (Bold) qilamiz
    If c = 1 Then t.Cell(r, c).Shape.TextFrame.TextRange.Font.Bold = msoTrue
End Sub
