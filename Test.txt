Sub RasmlarniFormatlash()
    Dim currentSlide As Slide
    Dim newSlide As Slide
    Dim shp As Shape
    Dim picCollection As New Collection
    Dim i As Integer
    Dim leftPos As Single, topPos As Single
    Dim imgWidth As Single, imgHeight As Single
    Dim col As Integer, row As Integer
    
    ' 1. Aktiv slaydni aniqlash
    Set currentSlide = ActiveWindow.View.Slide
    
    ' 2. Slayddagi barcha rasmlarni yig'ib olish
    For Each shp In currentSlide.Shapes
        ' Agar shakl rasm bo'lsa yoki rasm ramkasi bo'lsa
        If shp.Type = msoPicture Or shp.Type = msoLinkedPicture Then
            picCollection.Add shp
        End If
    Next shp
    
    ' Agar rasm topilmasa
    If picCollection.Count = 0 Then
        MsgBox "Bu slaydda rasm topilmadi!", vbExclamation
        Exit Sub
    End If
    
    ' 3. Yangi slayd ochish
    Set newSlide = ActivePresentation.Slides.Add(currentSlide.SlideIndex + 1, ppLayoutBlank)
    
    ' 4. Rasmlarni joylash parametrlari (O'ng tomon uchun)
    ' Bu yerda koordinatalarni o'zgartirishingiz mumkin
    Dim startX As Single: startX = 400 ' Chapdan qancha masofa (Tabledan keyin)
    Dim startY As Single: startY = 50  ' Tepadan masofa
    Dim gap As Single: gap = 10        ' Rasmlar orasidagi masofa
    
    ' Har bir rasm uchun o'lcham (taxminan 2-rasmdagi o'lcham)
    imgWidth = 220
    imgHeight = 150
    
    ' 5. Har bir rasmni ko'chirib, joylashtirish
    For i = 1 To picCollection.Count
        ' Rasmni nusxalash
        picCollection(i).Copy
        
        ' Yangi slaydga tashlash
        Dim newPic As ShapeRange
        Set newPic = newSlide.Shapes.Paste
        
        ' Joylashuvni hisoblash (2x2 matritsa)
        ' i=1 -> Row 0, Col 0
        ' i=2 -> Row 0, Col 1
        ' i=3 -> Row 1, Col 0
        ' i=4 -> Row 1, Col 1
        
        row = (i - 1) \ 2 ' Butun bo'lish (0 yoki 1)
        col = (i - 1) Mod 2 ' Qoldiq (0 yoki 1)
        
        leftPos = startX + (col * (imgWidth + gap))
        topPos = startY + (row * (imgHeight + gap))
        
        ' Rasmni joylash va o'lchamini to'g'irlash
        With newPic
            .LockAspectRatio = msoTrue ' Mashina shakli buzilmasligi uchun
            .Width = imgWidth
            ' Agar balandlik juda katta bo'lib ketsa, qirqamiz (Crop)
            If .Height > imgHeight Then
                .Height = imgHeight
            End If
            
            .Left = leftPos
            .Top = topPos
            
            ' Chiroyli ko'rinishi uchun ramka (ixtiyoriy)
            .Line.Visible = msoTrue
            .Line.ForeColor.RGB = RGB(200, 200, 200)
            .Line.Weight = 1
        End With
        
        ' Agar 4 tadan ko'p rasm bo'lsa, to'xtaymiz (dizayn buzilmasligi uchun)
        If i >= 4 Then Exit For
    Next i
    
    MsgBox "Rasmlar yangi slaydga o'tkazildi!", vbInformation

End Sub
